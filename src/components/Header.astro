---
import { Icon } from "astro-icon/components";
import { services } from "../data/services";
import Logo from "../assets/Logo.png";
import Image from "astro/components/Image.astro";

const healthSubLinks = [
  services.find((s) => s.name === "Özel Sağlık Sigortası"),
  services.find((s) => s.name === "Tamamlayıcı Sağlık Sigortası"),
  services.find((s) => s.name === "Seyahat Sigortası"),
].filter(Boolean); // Filter out any undefined if a service is not found

const serviceDropdownLinks = [
  services.find((s) => s.name === "Kasko Sigortası"),
  services.find((s) => s.name === "Zorunlu Trafik Sigortası"),
  { name: "Sağlık Sigortaları", url: "#", subLinks: healthSubLinks },
  services.find((s) => s.name === "Konut Sigortası"),
  services.find((s) => s.name === "DASK (Deprem Sigortası)"),
  services.find((s) => s.name === "Ferdi Kaza Sigortası"),
  services.find((s) => s.name === "İş Yeri Sigortası"),
].filter(Boolean);

const offerDropdownLinks = [
  { name: "Kasko Teklifi", url: "/teklifler/kasko-teklifi" },
  {
    name: "Trafik Sigortası Teklifi",
    url: "/teklifler/trafik-sigortasi-teklifi",
  },
  {
    name: "Yeşilkart Trafik Sigortası Teklifi",
    url: "/teklifler/yesilkart-trafik-sigortasi-teklifi",
  },
  {
    name: "Sağlık Sigortası Teklifi",
    url: "/teklifler/saglik-sigortasi-teklifi",
  },
  {
    name: "Tamamlayıcı Sağlık Sigortası Teklifi",
    url: "/teklifler/tamamlayici-saglik-sigortasi-teklifi",
  },
  {
    name: "Yabancı Sağlık Sigortası Teklifi",
    url: "/teklifler/yabanci-saglik-sigortasi-teklifi",
  },
  { name: "DASK/Yangın Teklifi", url: "/teklifler/dask-yangin-teklifi" },
  {
    name: "İşyeri Sigortası Teklifi",
    url: "/teklifler/isyeri-sigortasi-teklifi",
  },
];
---

<header class="font-sans">
  <!-- Top Bar -->
  <div class="bg-[#4DA8DA] text-white">
    <div
      class="px-10 md:px-8 lg:px-8 py-5 flex justify-center md:justify-between items-center text-sm"
    >
      <div class="flex flex-col md:flex-row items-center gap-10">
        <a
          href="tel:+905318664773"
          class="flex items-center gap-2 hover:text-gray-300"
        >
          <Icon name="mdi:phone" class="w-4 h-4" />
          <span>+90 531 866 47 73</span>
        </a>
        <a
          href="mailto:info@sakaryakayasigorta.com"
          class="flex items-center gap-2 hover:text-gray-300"
        >
          <Icon name="mdi:email" class="w-4 h-4" />
          <span>info@sakaryakayasigorta.com</span>
        </a>
      </div>
      <div class="hidden lg:flex items-center gap-4">
        <a href="#" aria-label="Facebook" class="hover:text-gray-300">
          <Icon name="mdi:facebook" class="w-5 h-5" />
        </a>
        <a href="#" aria-label="Twitter" class="hover:text-gray-300">
          <Icon name="mdi:twitter" class="w-5 h-5" />
        </a>
        <a href="#" aria-label="Instagram" class="hover:text-gray-300">
          <Icon name="mdi:instagram" class="w-5 h-5" />
        </a>
      </div>
    </div>
  </div>

  <!-- Main Header -->
  <div class="bg-white shadow-md">
    <div
      class="px-10 md:px-8 lg:px-8 py-4 md:py-6 flex justify-between items-center"
    >
      <!-- Logo -->
      <a href="/" class="flex items-center font-bold text-gray-800">
        <Image
          src={Logo}
          alt="Sigorta Logo"
          class="w-36 lg:h-32 lg:w-48 min-w-36"
        />
      </a>

      <!-- Mobile Menu Button -->
      <div class="lg:hidden">
        <button
          id="mobile-menu-button"
          class="text-gray-800 focus:outline-none"
        >
          <Icon name="mdi:menu" class="w-8 h-8" />
        </button>
      </div>

      <!-- Navigation -->
      <nav class="hidden lg:flex">
        <ul
          class="hidden lg:flex items-center text-lg gap-10 text-gray-600 font-medium"
        >
          <li>
            <a href="/" class="hover:text-blue-700 transition-colors"
              >Anasayfa</a
            >
          </li>
          <li>
            <a href="/hakkimizda" class="hover:text-blue-700 transition-colors"
              >Hakkımızda</a
            >
          </li>
          <li>
            <a href="/kampanyalar" class="hover:text-blue-700 transition-colors"
              >Kampanyalar</a
            >
          </li>
          <li class="relative group">
            <a
              href="/hizmetlerimiz"
              class="hover:text-blue-700 transition-colors flex items-center gap-1"
            >
              Hizmetlerimiz
              <Icon
                name="mdi:chevron-down"
                class="w-4 h-4 transition-transform group-hover:rotate-180"
              />
            </a>
            <div
              class="absolute hidden group-hover:block bg-white shadow-lg py-2 rounded-md z-10 min-w-[200px]"
            >
              <ul>
                {
                  serviceDropdownLinks.map((link) => (
                    <li class="relative group/item">
                      {link.subLinks ? (
                        <a
                          href={link.url}
                          class="flex items-center justify-between px-4 py-2 text-gray-800 hover:bg-gray-100 transition-colors"
                        >
                          {link.name}
                          <Icon name="mdi:chevron-right" class="w-4 h-4" />
                        </a>
                      ) : (
                        <a
                          href={link.url}
                          class="block px-4 py-2 text-gray-800 hover:bg-gray-100 transition-colors"
                        >
                          {link.name}
                        </a>
                      )}
                      {link.subLinks && (
                        <div class="absolute hidden group-hover/item:block bg-white shadow-lg py-2 rounded-md z-20 min-w-[200px] left-full top-0">
                          <ul>
                            {link.subLinks.map((subLink) => (
                              <li>
                                <a
                                  href={subLink.url}
                                  class="block px-4 py-2 text-gray-800 hover:bg-gray-100 transition-colors"
                                >
                                  {subLink.name}
                                </a>
                              </li>
                            ))}
                          </ul>
                        </div>
                      )}
                    </li>
                  ))
                }
              </ul>
            </div>
          </li>
          <li>
            <a href="/kampanyalar" class="hover:text-blue-700 transition-colors"
              >Kampanyalar</a
            >
          </li>
          <li class="relative group">
            <a
              href="/teklifler"
              class="hover:text-blue-700 transition-colors flex items-center gap-1"
            >
              Teklifler
              <Icon
                name="mdi:chevron-down"
                class="w-4 h-4 transition-transform group-hover:rotate-180"
              />
            </a>
            <div
              class="absolute hidden group-hover:block bg-white shadow-lg py-2 rounded-md z-10 min-w-[200px]"
            >
              <ul>
                {
                  offerDropdownLinks.map((link) => (
                    <li>
                      <a
                        href={link.url}
                        class="block px-4 py-2 text-gray-800 hover:bg-gray-100 transition-colors"
                      >
                        {link.name}
                      </a>
                    </li>
                  ))
                }
              </ul>
            </div>
          </li>
          <li>
            <a
              href="/kaza-tespit-tutanagi"
              class="hover:text-blue-700 transition-colors"
              >Kaza Tespit Tutanağı</a
            >
          </li>
          <li>
            <a href="/hakkimizda" class="hover:text-blue-700 transition-colors"
              >Hakkımızda</a
            >
          </li>
          <li>
            <a href="/iletisim" class="hover:text-blue-700 transition-colors"
              >İletişim</a
            >
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <!-- Mobile Menu Overlay -->
  <div
    id="mobile-menu-overlay"
    class="fixed inset-0 bg-black opacity-0 transition-opacity duration-300 ease-in-out z-40 pointer-events-none"
  >
  </div>

  <!-- Mobile Menu -->
  <div
    id="mobile-menu"
    class="fixed top-0 left-0 w-64 h-full bg-white shadow-lg transform -translate-x-full transition-transform duration-300 ease-in-out z-50"
  >
    <div class="p-4">
      <button
        id="mobile-menu-close-button"
        class="text-gray-800 focus:outline-none"
      >
        <Icon name="mdi:close" class="w-8 h-8" />
      </button>
      <nav class="mt-8">
        <ul>
          <li>
            <a href="/" class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >Anasayfa</a
            >
          </li>
          <li>
            <a
              href="/hakkimizda"
              class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >Hakkımızda</a
            >
          </li>
          <li>
            <a
              href="/kampanyalar"
              class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >Kampanyalar</a
            >
          </li>
          <li>
            <a
              href="/hizmetlerimiz"
              class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >Hizmetlerimiz</a
            >
          </li>
          <li>
            <a
              href="/teklifler"
              class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >Teklifler</a
            >
          </li>
          <li>
            <a
              href="/kaza-tespit-tutanagi"
              class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >Kaza Tespit Tutanağı</a
            >
          </li>
          <li>
            <a
              href="/hakkimizda"
              class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >Hakkımızda</a
            >
          </li>
          <li>
            <a
              href="/iletisim"
              class="block py-2 px-4 text-gray-800 hover:bg-gray-100"
              >İletişim</a
            >
          </li>
        </ul>
      </nav>
    </div>
  </div>
</header>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const mobileMenuButton = document.getElementById("mobile-menu-button");
    const mobileMenuCloseButton = document.getElementById(
      "mobile-menu-close-button",
    );
    const mobileMenu = document.getElementById("mobile-menu");
    const mobileMenuOverlay = document.getElementById("mobile-menu-overlay");

    if (
      mobileMenuButton &&
      mobileMenu &&
      mobileMenuCloseButton &&
      mobileMenuOverlay
    ) {
      mobileMenuButton.addEventListener("click", () => {
        mobileMenu.classList.remove("-translate-x-full");
        mobileMenu.classList.add("translate-x-0");
        mobileMenuOverlay.classList.remove("opacity-0", "pointer-events-none");
        mobileMenuOverlay.classList.add("opacity-50", "pointer-events-auto");
      });

      mobileMenuCloseButton.addEventListener("click", () => {
        mobileMenu.classList.add("-translate-x-full");
        mobileMenu.classList.remove("translate-x-0");
        mobileMenuOverlay.classList.add("opacity-0", "pointer-events-none");
        mobileMenuOverlay.classList.remove("opacity-50", "pointer-events-auto");
      });

      mobileMenuOverlay.addEventListener("click", () => {
        mobileMenu.classList.add("-translate-x-full");
        mobileMenu.classList.remove("translate-x-0");
        mobileMenuOverlay.classList.add("opacity-0", "pointer-events-none");
        mobileMenuOverlay.classList.remove("opacity-50", "pointer-events-auto");
      });
    }
  });
</script>
